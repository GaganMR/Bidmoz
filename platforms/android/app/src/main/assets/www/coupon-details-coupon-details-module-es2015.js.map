{"version":3,"sources":["./src/app/coupon-details/coupon-details.page.html","./src/app/coupon-details/coupon-details-routing.module.ts","./src/app/coupon-details/coupon-details.module.ts","./src/app/coupon-details/coupon-details.page.scss","./src/app/coupon-details/coupon-details.page.ts"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAe,k/BAAm7B,E;;;;;;;;;;;;;;;;;;;ACAz5B;AACc;AAEG;AAE1D,MAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,sEAAiB;KAC7B;CACF,CAAC;IAMW,8BAA8B,SAA9B,8BAA8B;CAAG;AAAjC,8BAA8B;IAJ1C,8DAAQ,CAAC;QACR,OAAO,EAAE,CAAC,4DAAY,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;QACxC,OAAO,EAAE,CAAC,4DAAY,CAAC;KACxB,CAAC;GACW,8BAA8B,CAAG;AAAH;;;;;;;;;;;;;;;;;;;;;;;AChBF;AACM;AACF;AAEA;AAEoC;AAEvB;IAW7C,uBAAuB,SAAvB,uBAAuB;CAAG;AAA1B,uBAAuB;IATnC,8DAAQ,CAAC;QACR,OAAO,EAAE;YACP,4DAAY;YACZ,0DAAW;YACX,0DAAW;YACX,6FAA8B;SAC/B;QACD,YAAY,EAAE,CAAC,sEAAiB,CAAC;KAClC,CAAC;GACW,uBAAuB,CAAG;AAAH;;;;;;;;;;;;;ACnBpC;AAAe,mEAAI,iBAAiB,GAAG,6CAA6C,2TAA2T,E;;;;;;;;;;;;;;;;;;;;ACA7V;AACO;AACE;AACS;IAUvD,iBAAiB,SAAjB,iBAAiB;IAK5B,YACU,iBAAmC,EACnC,MAAa,EACd,iBAAoC,EACpC,eAAgC,EAC/B,KAAqB;QAJrB,sBAAiB,GAAjB,iBAAiB,CAAkB;QACnC,WAAM,GAAN,MAAM,CAAO;QACd,sBAAiB,GAAjB,iBAAiB,CAAmB;QACpC,oBAAe,GAAf,eAAe,CAAiB;QAC/B,UAAK,GAAL,KAAK,CAAgB;QAC3B,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;IAChE,CAAC;IAEJ,QAAQ;IACR,CAAC;IAEK,eAAe;;YACnB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC;YAChE,IAAI,+BAA+B,GAAG;gBACpC,SAAS,EAAE,IAAI,CAAC,SAAS;gBACzB,OAAO,EAAE,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,OAAO;aAClD;YACD,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC;gBAClD,OAAO,EAAE,gBAAgB;aAC1B,CAAC,CAAC;YACH,MAAM,OAAO,CAAC,OAAO,EAAE,CAAC;YACxB,MAAM,IAAI,CAAC,iBAAiB,CAAC,2BAA2B,CAAC,+BAA+B,CAAC,CAAC,SAAS,CAAC,CAAC,MAAU,EAAC,EAAE;gBAChH,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;gBACpB,IAAI,OAAO,GAAG;oBACZ,WAAW,EAAE,MAAM,CAAC,WAAW;oBAC/B,6BAA6B;oBAC7B,QAAQ,EAAE,MAAM,CAAC,QAAQ;oBACzB,GAAG,EAAC,MAAM,CAAC,GAAG;oBACd,MAAM,EAAC,MAAM,CAAC,MAAM;oBACpB,IAAI,EAAE,QAAQ;oBACd,OAAO,EAAC;wBACN,KAAK,EAAE,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,KAAK;wBAC7C,OAAO,EAAE,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,QAAQ;wBAClD,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,OAAO;qBAC/C;oBACD,KAAK,EAAE;wBACL,KAAK,EAAE,SAAS;qBACjB;iBACF;gBACD,IAAI,eAAe,GAAG,UAAS,OAAO;oBACpC,sDAAsD;oBACtD,wDAAwD;oBACxD,oDAAoD;oBACpD,sDAAsD;oBACtD,OAAO,CAAC,OAAO,EAAE,CAAC;oBAClB,IAAI,CAAC,0BAA0B,CAAC,MAAM,CAAC,kBAAkB,EAAE,mBAAmB,EAAE,OAAO,CAAC,mBAAmB,EAAE,OAAO,CAAC,iBAAiB,EAAE,OAAO,CAAC,kBAAkB,EAAE,mBAAmB,CAAC,CAAC;gBAC3L,CAAC;gBACD,IAAI,cAAc,GAAG,UAAS,KAAK;oBACjC,KAAK,CAAC,KAAK,CAAC,WAAW,GAAG,UAAU,GAAC,KAAK,CAAC,IAAI,GAAC,GAAG,CAAC;oBACpD,OAAO,CAAC,OAAO,EAAE,CAAC;gBACpB,CAAC;gBACD,gBAAgB,CAAC,EAAE,CAAC,iBAAiB,EAAE,eAAe,CAAC;gBACvD,gBAAgB,CAAC,EAAE,CAAC,gBAAgB,EAAE,cAAc,CAAC;gBACrD,gBAAgB,CAAC,IAAI,CAAC,OAAO,EAAC,eAAe,EAAE,cAAc,CAAC;gBAC9D,sCAAsC;YACxC,CAAC,CAAC;QAEJ,CAAC;KAAA;IAEK,0BAA0B,CAAC,kBAAkB,EAAE,cAAc,EAAE,mBAAmB,EAAE,iBAAiB,EAAE,kBAAkB,EAAE,OAAO;;YAEtI,IAAI,oBAAoB,GAAG;gBACzB,OAAO,EAAE,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,OAAO;gBACjD,SAAS,EAAE,IAAI,CAAC,SAAS;gBACzB,kBAAkB,EAAE,kBAAkB;gBACtC,mBAAmB,EAAE,mBAAmB;gBACxC,iBAAiB,EAAE,iBAAiB;gBACpC,kBAAkB,EAAE,kBAAkB;gBACtC,cAAc,EAAE,cAAc;aAC/B;YAED,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC;gBAClD,OAAO,EAAE,6BAA6B;aACvC,CAAC,CAAC;YACH,MAAM,OAAO,CAAC,OAAO,EAAE,CAAC;YACxB,MAAM,IAAI,CAAC,iBAAiB,CAAC,0BAA0B,CAAC,oBAAoB,CAAC,CAAC,SAAS,CAAC,CAAC,GAAO,EAAC,EAAE;gBAEjG,IAAG,GAAG,EAAC;oBACL,IAAG,GAAG,CAAC,MAAM,KAAK,SAAS,EAAC;wBAC1B,YAAY,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;wBACpC,YAAY,CAAC,OAAO,CAAC,UAAU,EAAE,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC;wBACtD,OAAO,CAAC,OAAO,EAAE,CAAC;wBAClB,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,kBAAkB,CAAC,CAAC,CAAC;qBAC5C;yBAAM;wBACL,OAAO,CAAC,OAAO,EAAE,CAAC;wBAClB,IAAI,CAAC,mBAAmB,CAAC,gBAAgB,EAAE,wDAAwD,CAAC,CAAC;qBACtG;iBAEF;qBAAM;oBACL,OAAO,CAAC,OAAO,EAAE,CAAC;oBAClB,IAAI,CAAC,mBAAmB,CAAC,gBAAgB,EAAE,wDAAwD,CAAC,CAAC;iBACtG;YAEH,CAAC,CAAC;QAGJ,CAAC;KAAA;IAED,mBAAmB,CAAC,UAAU,EAAE,GAAG;QACjC,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;YAC1B,kBAAkB;YAClB,SAAS,EAAE,UAAU;YACrB,OAAO,EAAE,GAAG;YACZ,OAAO,EAAE,CAAC,IAAI,CAAC;SAChB,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE;YAEZ,GAAG,CAAC,OAAO,EAAE,CAAC;QAEhB,CAAC,CAAC,CAAC;IACL,CAAC;CAEF;;YAhIQ,sEAAiB;YADD,sDAAM;YAEL,gEAAiB;YAAlC,8DAAe;YAFf,8DAAc;;AAYV,iBAAiB;IAN7B,+DAAS,CAAC;QACT,QAAQ,EAAE,oBAAoB;QAC9B,4OAAyC;;KAE1C,CAAC;GAEW,iBAAiB,CAqH7B;AArH6B","file":"coupon-details-coupon-details-module-es2015.js","sourcesContent":["export default \"<ion-header>\\r\\n  <ion-toolbar color=\\\"featured\\\">\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-back-button defaultHref=\\\"/bid-plans\\\"></ion-back-button>\\r\\n    </ion-buttons>\\r\\n    <ion-title>Coupon details</ion-title>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content>\\r\\n  <div></div>\\r\\n  <ion-grid>\\r\\n    <ion-row>\\r\\n      <ion-col class=\\\"ion-text-justify\\\">\\r\\n        <p>Valid Only for 24 hrs</p>\\r\\n        <p>Coupon Price depends upon product category</p>\\r\\n      <p>Can be used only once for a product, connot be used for other product. But once used for a product, the product can be bid any no of times</p>\\r\\n      </ion-col>\\r\\n    </ion-row>\\r\\n  </ion-grid>\\r\\n</ion-content>\\r\\n<ion-footer no-shadow>\\r\\n  <ion-toolbar color=\\\"featured\\\" position=\\\"bottom\\\">\\r\\n    <ion-button  color=\\\"custom-button\\\" slot=\\\"end\\\" (click)=\\\"payWithRazorpay()\\\">Purchase Coupon</ion-button>\\r\\n  </ion-toolbar>\\r\\n</ion-footer>\";","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { CouponDetailsPage } from './coupon-details.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: CouponDetailsPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class CouponDetailsPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { CouponDetailsPageRoutingModule } from './coupon-details-routing.module';\r\n\r\nimport { CouponDetailsPage } from './coupon-details.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    CouponDetailsPageRoutingModule\r\n  ],\r\n  declarations: [CouponDetailsPage]\r\n})\r\nexport class CouponDetailsPageModule {}\r\n","export default \"p {\\n  color: white;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY291cG9uLWRldGFpbHMvY291cG9uLWRldGFpbHMucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksWUFBQTtBQUNKIiwiZmlsZSI6InNyYy9hcHAvY291cG9uLWRldGFpbHMvY291cG9uLWRldGFpbHMucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsicHtcclxuICAgIGNvbG9yOiB3aGl0ZTtcclxufSJdfQ== */\";","import { Component, OnInit } from '@angular/core';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { ApiServiceService } from '../api-service.service';\r\nimport { AlertController, LoadingController } from '@ionic/angular';\r\n\r\ndeclare var RazorpayCheckout:any;\r\n\r\n@Component({\r\n  selector: 'app-coupon-details',\r\n  templateUrl: './coupon-details.page.html',\r\n  styleUrls: ['./coupon-details.page.scss'],\r\n})\r\n\r\nexport class CouponDetailsPage implements OnInit {\r\n  \r\n  userDetails: any;\r\n  coupon_id: any;\r\n\r\n  constructor(\r\n    private apiServiceService:ApiServiceService,\r\n    private routes:Router,\r\n    public loadingController: LoadingController,\r\n    public alertController: AlertController,\r\n    private route: ActivatedRoute) {\r\n      this.coupon_id = this.route.snapshot.paramMap.get('coupon_id'); \r\n     }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  async payWithRazorpay() {\r\n    this.userDetails = JSON.parse(localStorage.getItem('userData'));\r\n    let generateCouponPurchaseOrderData = {\r\n      coupon_id: this.coupon_id,\r\n      user_id: this.userDetails.user_details[0].user_id\r\n    }\r\n    const loading = await this.loadingController.create({\r\n      message: 'Please wait...'\r\n    });\r\n    await loading.present();\r\n    await this.apiServiceService.generateCouponPurchaseOrder(generateCouponPurchaseOrderData).subscribe((result:any)=>{\r\n      console.log(result);\r\n      var options = {\r\n        description: result.description,\r\n        // order_id: result.order_id,\r\n        currency: result.currency,\r\n        key:result.key,\r\n        amount:result.amount,\r\n        name: 'Bidmoz',\r\n        prefill:{\r\n          email: this.userDetails.user_details[0].email,\r\n          contact: this.userDetails.user_details[0].phone_no,\r\n          name: this.userDetails.user_details[0].user_id\r\n        },\r\n        theme: {\r\n          color: \"#222428\"\r\n        }\r\n      }\r\n      var successCallback = function(success) {\r\n        // alert('payment_id: ' + success.razorpay_payment_id)\r\n        // var razorpay_payment_id = success.razorpay_payment_id\r\n        // var razorpay_order_id = success.razorpay_order_id\r\n        // var razorpay_signature = success.razorpay_signature\r\n        loading.dismiss();\r\n        this.updateCouponPaymentDetails(result.payment_details_id, \"Payment Completed\", success.razorpay_payment_id, success.razorpay_order_id, success.razorpay_signature, \"Payment Completed\");\r\n      }\r\n      var cancelCallback = function(error) {\r\n        alert(error.description + ' (Error '+error.code+')')\r\n        loading.dismiss();\r\n      }\r\n      RazorpayCheckout.on('payment.success', successCallback)\r\n      RazorpayCheckout.on('payment.cancel', cancelCallback)\r\n      RazorpayCheckout.open(options,successCallback, cancelCallback)\r\n      // console.log(this.RazorpayCheckout);\r\n    })\r\n\r\n  }\r\n\r\n  async updateCouponPaymentDetails(payment_details_id, payment_status, razorpay_payment_id, razorpay_order_id, razorpay_signature, remarks) {\r\n\r\n    let couponPaymentDetails = {\r\n      user_id: this.userDetails.user_details[0].user_id,\r\n      coupon_id: this.coupon_id,\r\n      payment_details_id: payment_details_id,\r\n      razorpay_payment_id: razorpay_payment_id,\r\n      razorpay_order_id: razorpay_order_id,\r\n      razorpay_signature: razorpay_signature,\r\n      payment_status: payment_status\r\n    }\r\n\r\n    const loading = await this.loadingController.create({\r\n      message: 'Updating payment details...'\r\n    });\r\n    await loading.present();\r\n    await this.apiServiceService.updateCouponPaymentDetails(couponPaymentDetails).subscribe((res:any)=>{\r\n\r\n      if(res){\r\n        if(res.status === \"Success\"){\r\n          localStorage.removeItem('userData');\r\n          localStorage.setItem('userData', JSON.stringify(res));\r\n          loading.dismiss();\r\n          this.routes.navigate(['current-sessions']);\r\n        } else {\r\n          loading.dismiss();\r\n          this.showAlertController(\"Coupon update!\", \"Failed to update user details, please try again later.\");\r\n        }\r\n        \r\n      } else {\r\n        loading.dismiss();\r\n        this.showAlertController(\"Coupon update!\", \"Failed to update user details, please try again later.\");\r\n      }\r\n\r\n    })\r\n\r\n\r\n  }\r\n\r\n  showAlertController(sub_header, msg) {\r\n    this.alertController.create({\r\n      //header: 'Alert',\r\n      subHeader: sub_header,\r\n      message: msg,\r\n      buttons: ['OK']\r\n    }).then(res => {\r\n\r\n      res.present();\r\n\r\n    });\r\n  }\r\n\r\n}\r\n"],"sourceRoot":"webpack:///"}