{"version":3,"sources":["webpack:///src/app/coupon-details/coupon-details.page.html","webpack:///src/app/coupon-details/coupon-details-routing.module.ts","webpack:///src/app/coupon-details/coupon-details.module.ts","webpack:///src/app/coupon-details/coupon-details.page.scss","webpack:///src/app/coupon-details/coupon-details.page.ts"],"names":["routes","path","component","CouponDetailsPageRoutingModule","imports","forChild","exports","CouponDetailsPageModule","declarations","CouponDetailsPage","apiServiceService","loadingController","alertController","route","coupon_id","snapshot","paramMap","get","userDetails","JSON","parse","localStorage","getItem","generateCouponPurchaseOrderData","user_id","user_details","create","message","loading","present","generateCouponPurchaseOrder","subscribe","result","console","log","options","description","currency","key","amount","name","prefill","email","contact","phone_no","theme","color","successCallback","success","alert","razorpay_payment_id","razorpay_order_id","razorpay_signature","dismiss","cancelCallback","error","code","RazorpayCheckout","on","open","payment_details_id","payment_status","remarks","couponPaymentDetails","updateCouponPaymentDetails","res","status","removeItem","setItem","stringify","navigate","showAlertController","sub_header","msg","subHeader","buttons","then","selector","template"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AAAe;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACKf,UAAMA,MAAM,GAAW,CACrB;AACEC,YAAI,EAAE,EADR;AAEEC,iBAAS,EAAE;AAFb,OADqB,CAAvB;;UAWaC,8BAA8B;AAAA;AAAA,O;;AAA9BA,oCAA8B,6DAJ1C,+DAAS;AACRC,eAAO,EAAE,CAAC,6DAAaC,QAAb,CAAsBL,MAAtB,CAAD,CADD;AAERM,eAAO,EAAE,CAAC,4DAAD;AAFD,OAAT,CAI0C,GAA9BH,8BAA8B,CAA9B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UCGAI,uBAAuB;AAAA;AAAA,O;;AAAvBA,6BAAuB,6DATnC,+DAAS;AACRH,eAAO,EAAE,CACP,4DADO,EAEP,0DAFO,EAGP,0DAHO,EAIP,6FAJO,CADD;AAORI,oBAAY,EAAE,CAAC,sEAAD;AAPN,OAAT,CASmC,GAAvBD,uBAAuB,CAAvB;;;;;;;;;;;;;;;;ACnBb;AAAe;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UCaFE,iBAAiB;AAK5B,mCACUC,iBADV,EAEUV,MAFV,EAGSW,iBAHT,EAISC,eAJT,EAKUC,KALV,EAKiC;AAAA;;AAJvB,eAAAH,iBAAA,GAAAA,iBAAA;AACA,eAAAV,MAAA,GAAAA,MAAA;AACD,eAAAW,iBAAA,GAAAA,iBAAA;AACA,eAAAC,eAAA,GAAAA,eAAA;AACC,eAAAC,KAAA,GAAAA,KAAA;AACN,eAAKC,SAAL,GAAiB,KAAKD,KAAL,CAAWE,QAAX,CAAoBC,QAApB,CAA6BC,GAA7B,CAAiC,WAAjC,CAAjB;AACA;;AAZwB;AAAA;AAAA,qCAcjB,CACV;AAf2B;AAAA;AAAA,4CAiBJ;;;;;;;;;AACtB,2BAAKC,WAAL,GAAmBC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAX,CAAnB;AACIC,qD,GAAkC;AACpCT,iCAAS,EAAE,KAAKA,SADoB;AAEpCU,+BAAO,EAAE,KAAKN,WAAL,CAAiBO,YAAjB,CAA8B,CAA9B,EAAiCD;AAFN,uB;;AAItB,6BAAM,KAAKb,iBAAL,CAAuBe,MAAvB,CAA8B;AAClDC,+BAAO,EAAE;AADyC,uBAA9B,CAAN;;;AAAVC,6B;;AAGN,6BAAMA,OAAO,CAACC,OAAR,EAAN;;;;AACA,6BAAM,KAAKnB,iBAAL,CAAuBoB,2BAAvB,CAAmDP,+BAAnD,EAAoFQ,SAApF,CAA8F,UAACC,MAAD,EAAc;AAChHC,+BAAO,CAACC,GAAR,CAAYF,MAAZ;AACA,4BAAIG,OAAO,GAAG;AACZC,qCAAW,EAAEJ,MAAM,CAACI,WADR;AAEZ;AACAC,kCAAQ,EAAEL,MAAM,CAACK,QAHL;AAIZC,6BAAG,EAACN,MAAM,CAACM,GAJC;AAKZC,gCAAM,EAACP,MAAM,CAACO,MALF;AAMZC,8BAAI,EAAE,QANM;AAOZC,iCAAO,EAAC;AACNC,iCAAK,EAAE,KAAI,CAACxB,WAAL,CAAiBO,YAAjB,CAA8B,CAA9B,EAAiCiB,KADlC;AAENC,mCAAO,EAAE,KAAI,CAACzB,WAAL,CAAiBO,YAAjB,CAA8B,CAA9B,EAAiCmB,QAFpC;AAGNJ,gCAAI,EAAE,KAAI,CAACtB,WAAL,CAAiBO,YAAjB,CAA8B,CAA9B,EAAiCD;AAHjC,2BAPI;AAYZqB,+BAAK,EAAE;AACLC,iCAAK,EAAE;AADF;AAZK,yBAAd;;AAgBA,4BAAIC,eAAe,GAAG,SAAlBA,eAAkB,CAASC,OAAT,EAAkB;AACtCC,+BAAK,CAAC,0BAA0BD,OAAO,CAACE,mBAAlC,GAAwD,uBAAxD,GAAkFF,OAAO,CAACG,iBAA1F,GAA8G,wBAA9G,GAAyIH,OAAO,CAACI,kBAAlJ,CAAL,CADsC,CAEtC;AACA;AACA;;AACAxB,iCAAO,CAACyB,OAAR,GALsC,CAMtC;AACA;AACD,yBARD;;AASA,4BAAIC,cAAc,GAAG,SAAjBA,cAAiB,CAASC,KAAT,EAAgB;AACnCN,+BAAK,CAACM,KAAK,CAACnB,WAAN,GAAoB,UAApB,GAA+BmB,KAAK,CAACC,IAArC,GAA0C,GAA3C,CAAL;AACA5B,iCAAO,CAACyB,OAAR;AACD,yBAHD;;AAIAI,wCAAgB,CAACC,EAAjB,CAAoB,iBAApB,EAAuCX,eAAvC;AACAU,wCAAgB,CAACC,EAAjB,CAAoB,gBAApB,EAAsCJ,cAAtC;AACAG,wCAAgB,CAACE,IAAjB,CAAsBxB,OAAtB,EAA+BY,eAA/B,EAAgDO,cAAhD,EAjCgH,CAkChH;AACD,uBAnCK,CAAN;;;;;;;;;AAqCD;AAhE2B;AAAA;AAAA,qDAkEKM,kBAlEL,EAkEyBC,cAlEzB,EAkEyCX,mBAlEzC,EAkE8DC,iBAlE9D,EAkEiFC,kBAlEjF,EAkEqGU,OAlErG,EAkE8G;;;;;;;;;AAEpIC,0C,GAAuB;AACzBvC,+BAAO,EAAE,KAAKN,WAAL,CAAiBO,YAAjB,CAA8B,CAA9B,EAAiCD,OADjB;AAEzBV,iCAAS,EAAE,KAAKA,SAFS;AAGzB8C,0CAAkB,EAAEA,kBAHK;AAIzBV,2CAAmB,EAAEA,mBAJI;AAKzBC,yCAAiB,EAAEA,iBALM;AAMzBC,0CAAkB,EAAEA,kBANK;AAOzBS,sCAAc,EAAEA;AAPS,uB;;AAUX,6BAAM,KAAKlD,iBAAL,CAAuBe,MAAvB,CAA8B;AAClDC,+BAAO,EAAE;AADyC,uBAA9B,CAAN;;;AAAVC,6B;;AAGN,6BAAMA,OAAO,CAACC,OAAR,EAAN;;;;AACA,6BAAM,KAAKnB,iBAAL,CAAuBsD,0BAAvB,CAAkDD,oBAAlD,EAAwEhC,SAAxE,CAAkF,UAACkC,GAAD,EAAW;AAEjG,4BAAGA,GAAH,EAAO;AACL,8BAAGA,GAAG,CAACC,MAAJ,KAAe,SAAlB,EAA4B;AAC1B7C,wCAAY,CAAC8C,UAAb,CAAwB,UAAxB;AACA9C,wCAAY,CAAC+C,OAAb,CAAqB,UAArB,EAAiCjD,IAAI,CAACkD,SAAL,CAAeJ,GAAf,CAAjC;AACArC,mCAAO,CAACyB,OAAR;;AACA,kCAAI,CAACrD,MAAL,CAAYsE,QAAZ,CAAqB,CAAC,kBAAD,CAArB;AACD,2BALD,MAKO;AACL1C,mCAAO,CAACyB,OAAR;;AACA,kCAAI,CAACkB,mBAAL,CAAyB,gBAAzB,EAA2C,wDAA3C;AACD;AAEF,yBAXD,MAWO;AACL3C,iCAAO,CAACyB,OAAR;;AACA,gCAAI,CAACkB,mBAAL,CAAyB,gBAAzB,EAA2C,wDAA3C;AACD;AAEF,uBAlBK,CAAN;;;;;;;;;AAoBD;AAtG2B;AAAA;AAAA,8CAwGRC,UAxGQ,EAwGIC,GAxGJ,EAwGS;AACnC,iBAAK7D,eAAL,CAAqBc,MAArB,CAA4B;AAC1B;AACAgD,uBAAS,EAAEF,UAFe;AAG1B7C,qBAAO,EAAE8C,GAHiB;AAI1BE,qBAAO,EAAE,CAAC,IAAD;AAJiB,aAA5B,EAKGC,IALH,CAKQ,UAAAX,GAAG,EAAI;AAEbA,iBAAG,CAACpC,OAAJ;AAED,aATD;AAUD;AAnH2B;;AAAA;AAAA,S;;;;gBAXrB;;gBADgB;;gBAEC;;gBAAjB;;gBAFA;;;;AAYIpB,uBAAiB,6DAN7B,gEAAU;AACToE,gBAAQ,EAAE,oBADD;AAETC,gBAAQ,EAAR;AAAA;AAAA,8GAFS;;;;AAAA,OAAV,CAM6B,GAAjBrE,iBAAiB,CAAjB","file":"coupon-details-coupon-details-module-es5.js","sourcesContent":["export default \"<ion-header>\\r\\n  <ion-toolbar color=\\\"featured\\\">\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-back-button defaultHref=\\\"/bid-plans\\\"></ion-back-button>\\r\\n    </ion-buttons>\\r\\n    <ion-title>Coupon details</ion-title>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content>\\r\\n  <div></div>\\r\\n  <ion-grid>\\r\\n    <ion-row>\\r\\n      <ion-col class=\\\"ion-text-justify\\\">\\r\\n        <p>Valid Only for 24 hrs</p>\\r\\n        <p>Coupon Price depends upon product category</p>\\r\\n      <p>Can be used only once for a product, connot be used for other product. But once used for a product, the product can be bid any no of times</p>\\r\\n      </ion-col>\\r\\n    </ion-row>\\r\\n  </ion-grid>\\r\\n</ion-content>\\r\\n<ion-footer no-shadow>\\r\\n  <ion-toolbar color=\\\"featured\\\" position=\\\"bottom\\\">\\r\\n    <ion-button  color=\\\"custom-button\\\" slot=\\\"end\\\" (click)=\\\"payWithRazorpay()\\\">Purchase Coupon</ion-button>\\r\\n  </ion-toolbar>\\r\\n</ion-footer>\";","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { CouponDetailsPage } from './coupon-details.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: CouponDetailsPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class CouponDetailsPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { CouponDetailsPageRoutingModule } from './coupon-details-routing.module';\r\n\r\nimport { CouponDetailsPage } from './coupon-details.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    CouponDetailsPageRoutingModule\r\n  ],\r\n  declarations: [CouponDetailsPage]\r\n})\r\nexport class CouponDetailsPageModule {}\r\n","export default \"p {\\n  color: white;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY291cG9uLWRldGFpbHMvY291cG9uLWRldGFpbHMucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksWUFBQTtBQUNKIiwiZmlsZSI6InNyYy9hcHAvY291cG9uLWRldGFpbHMvY291cG9uLWRldGFpbHMucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsicHtcclxuICAgIGNvbG9yOiB3aGl0ZTtcclxufSJdfQ== */\";","import { Component, OnInit } from '@angular/core';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { ApiServiceService } from '../api-service.service';\r\nimport { AlertController, LoadingController } from '@ionic/angular';\r\n\r\ndeclare var RazorpayCheckout:any;\r\n\r\n@Component({\r\n  selector: 'app-coupon-details',\r\n  templateUrl: './coupon-details.page.html',\r\n  styleUrls: ['./coupon-details.page.scss'],\r\n})\r\n\r\nexport class CouponDetailsPage implements OnInit {\r\n  \r\n  userDetails: any;\r\n  coupon_id: any;\r\n\r\n  constructor(\r\n    private apiServiceService:ApiServiceService,\r\n    private routes:Router,\r\n    public loadingController: LoadingController,\r\n    public alertController: AlertController,\r\n    private route: ActivatedRoute) {\r\n      this.coupon_id = this.route.snapshot.paramMap.get('coupon_id'); \r\n     }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  async payWithRazorpay() {\r\n    this.userDetails = JSON.parse(localStorage.getItem('userData'));\r\n    let generateCouponPurchaseOrderData = {\r\n      coupon_id: this.coupon_id,\r\n      user_id: this.userDetails.user_details[0].user_id\r\n    }\r\n    const loading = await this.loadingController.create({\r\n      message: 'Please wait...'\r\n    });\r\n    await loading.present();\r\n    await this.apiServiceService.generateCouponPurchaseOrder(generateCouponPurchaseOrderData).subscribe((result:any)=>{\r\n      console.log(result);\r\n      var options = {\r\n        description: result.description,\r\n        // order_id: result.order_id,\r\n        currency: result.currency,\r\n        key:result.key,\r\n        amount:result.amount,\r\n        name: 'Bidmoz',\r\n        prefill:{\r\n          email: this.userDetails.user_details[0].email,\r\n          contact: this.userDetails.user_details[0].phone_no,\r\n          name: this.userDetails.user_details[0].user_id\r\n        },\r\n        theme: {\r\n          color: \"#222428\"\r\n        }\r\n      }\r\n      var successCallback = function(success) {\r\n        alert('razorpay_payment_id: ' + success.razorpay_payment_id + '\\nrazorpay_order_id: ' + success.razorpay_order_id + '\\nrazorpay_signature: ' + success.razorpay_signature)\r\n        // var razorpay_payment_id = success.razorpay_payment_id\r\n        // var razorpay_order_id = success.razorpay_order_id\r\n        // var razorpay_signature = success.razorpay_signature\r\n        loading.dismiss();\r\n        //this.updateCouponPaymentDetails(result.payment_details_id, \"Payment Completed\", success.razorpay_payment_id, success.razorpay_order_id, success.razorpay_signature, \"Payment Completed\");\r\n        // this.updateCouponPaymentDetails(result.payment_details_id, \"Payment Completed\", '11111111111111111', '281643789', 'akcjbadc832duoecdjcbn', \"Payment Completed\");\r\n      }\r\n      var cancelCallback = function(error) {\r\n        alert(error.description + ' (Error '+error.code+')')\r\n        loading.dismiss();\r\n      }\r\n      RazorpayCheckout.on('payment.success', successCallback)\r\n      RazorpayCheckout.on('payment.cancel', cancelCallback)\r\n      RazorpayCheckout.open(options, successCallback, cancelCallback)\r\n      // console.log(this.RazorpayCheckout);\r\n    })\r\n\r\n  }\r\n\r\n  async updateCouponPaymentDetails(payment_details_id, payment_status, razorpay_payment_id, razorpay_order_id, razorpay_signature, remarks) {\r\n\r\n    let couponPaymentDetails = {\r\n      user_id: this.userDetails.user_details[0].user_id,\r\n      coupon_id: this.coupon_id,\r\n      payment_details_id: payment_details_id,\r\n      razorpay_payment_id: razorpay_payment_id,\r\n      razorpay_order_id: razorpay_order_id,\r\n      razorpay_signature: razorpay_signature,\r\n      payment_status: payment_status\r\n    }\r\n\r\n    const loading = await this.loadingController.create({\r\n      message: 'Updating payment details...'\r\n    });\r\n    await loading.present();\r\n    await this.apiServiceService.updateCouponPaymentDetails(couponPaymentDetails).subscribe((res:any)=>{\r\n\r\n      if(res){\r\n        if(res.status === \"Success\"){\r\n          localStorage.removeItem('userData');\r\n          localStorage.setItem('userData', JSON.stringify(res));\r\n          loading.dismiss();\r\n          this.routes.navigate(['current-sessions']);\r\n        } else {\r\n          loading.dismiss();\r\n          this.showAlertController(\"Coupon update!\", \"Failed to update user details, please try again later.\");\r\n        }\r\n        \r\n      } else {\r\n        loading.dismiss();\r\n        this.showAlertController(\"Coupon update!\", \"Failed to update user details, please try again later.\");\r\n      }\r\n\r\n    })\r\n\r\n  }\r\n\r\n  showAlertController(sub_header, msg) {\r\n    this.alertController.create({\r\n      //header: 'Alert',\r\n      subHeader: sub_header,\r\n      message: msg,\r\n      buttons: ['OK']\r\n    }).then(res => {\r\n\r\n      res.present();\r\n\r\n    });\r\n  }\r\n\r\n}\r\n"]}